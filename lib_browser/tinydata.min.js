!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("TinyData",[],t):"object"==typeof exports?exports.TinyData=t():e.TinyData=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";function r(e){if(!1===e||!0===e)return"BOOLEAN";switch((0,o.default)(e)){case"Object":return"HASH";case"Array":return"ARRAY";case"string":return"STRING";case"number":return"NUMBER";case"null":return"NULL";case"undefined":return"UNDEFINED";case"function":return"FUNCTION";case"RegExp":return"REGEXP";case"Date":return"DATE";case"Arguments":return"ARGUMENTS";default:return"OTHER"}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n){var r=void 0,i=(0,o.default)(e),u=function(e,n){return e+"\n|argName| = |"+t+"|\n|type| = |"+n+"|\n|arg| = |#{arg}|"};switch(i){case"STRING":try{r=["REGEXP",RegExp(e)]}catch(e){throw SyntaxError(u("cant compile this String to RegExp",i))}break;case"REGEXP":r=["REGEXP",e];break;case"FUNCTION":r=["FUNCTION",e];break;default:throw TypeError(u("argument must be String, RegExp or Function, but got",i))}if(n&&r[0]!==n.toUpperCase())throw TypeError(u("argument must be "+n+", but got",i));return r}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return function(t,n){var r=(0,u.default)(t),i=(0,u.default)(n);"NULL"!==r&&"UNDEFINED"!==r&&"NULL"!==i&&"UNDEFINED"!==i&&(e[t]||(e[t]=[]),e[t].push(n))}}function i(e){return function(t){var n={},i=(0,u.default)(t),o=r(n);switch(i){case"ARRAY":t.forEach(function(t){e(t,o)});break;case"HASH":Object.keys(t).forEach(function(n){e(n,t[n],o)});break;default:throw Error("cant work with object type |"+i+"|")}return n}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),s=r(a),c=n(7),f=r(c),l=n(9),d=r(l),p=n(10),h=r(p),y=n(1),g=r(y),v=n(2),b=r(v),m=n(11),E=r(m),k="ï¹…",O=".",_=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,e),this.originalObj=t,this.options=n,this.isConvertIncomePatterns=!0,this.logger=new h.default(n),this.dotForger=new s.default(k,{log:this.logger.mustDo("logging")}),this.doTransormRegExp=this.doTransormRegExp.bind(this),this.stringificator=new f.default(t,k,this.doTransormRegExp,{log:this.logger.mustDo("logging")}),this.finalizer=new d.default(k,O)}return u(e,[{key:"search",value:function(e,t,n){var r=(0,E.default)({key:1,value:2},n);return this.logger.mustDo("warning")&&r.key>=r.value&&console.warn("for reverse interpretation direction it would be better to use #searchBack()\n|key_order| = |"+r.key+"|\n|value_order| = |"+r.value+"|"),this.seekOutAny(e,t,r)}},{key:"searchBack",value:function(e,t,n){var r=(0,E.default)({key:2,value:1},n);return this.logger.mustDo("warning")&&r.value>=r.key&&console.warn("for direct interpretation direction it would be better to use #search()\n|key_order| = |"+r.key+"|\n|value_order| = |"+r.value+"|"),this.seekOutAny(e,t,r)}},{key:"seekOut",value:function(e,t,n){return this.search(e,t,n)}},{key:"seekOutVerso",value:function(e,t,n){return this.searchBack(e,t,n)}},{key:"timeOnDemand",value:function(e,t){var n=void 0,r=this.logger.mustDo("timing");return r&&console.time(e),n=t(),r&&console.timeEnd(e),n}},{key:"rakeStringify",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return this.timeOnDemand("rakeStringify",function(){return t.stringificator.stringifyObject(e,n)})}},{key:"doTransormRegExp",value:function(e){return-1!==e.source.indexOf(k)?(this.logger.mustDo("logging")&&console.log("doTransormRegExp: skip converting for |"+e+"|"),e):this.dotForger.doForgeDots(e)}},{key:"getInternalDelimiter",value:function(){return this.getPathDelimiter("INTERNAL")}},{key:"getPathDelimiter",value:function(e){switch(e.toUpperCase()){case"INTERNAL":return k;case"EXTERNAL":return O;default:throw Error("dont know path delimiter, named |"+e+"|, mistype?")}}},{key:"getDataByPath",value:function(e,t,n){var r=void 0;return n||(n=e&&-1!==e.indexOf(k)?k:O),t||(t=this.originalObj),r=e.split(n),r.reduce(function(e,t){return e[t]},t)}},{key:"seekOutAny",value:function(e,t,n){var r=void 0,i=void 0,u=void 0,a=void 0,s=this.rakeStringify(),c=(0,g.default)(e,"seek_rule"),f=o(c,2);return r=f[0],i=f[1],u=this.buildSeekFunction(r,i,n),a=this.proceedSeekingOut(u,s),this.proceedFinalization(t,a)}},{key:"proceedFinalization",value:function(e,t){var n=this;return this.timeOnDemand("finalization",function(){return n.finalizer.finalizeResult(e,t)})}},{key:"proceedSeekingOut",value:function(e,t){return this.timeOnDemand("searching",function(){return e(t)})}},{key:"buildSeekFunction",value:function(e,t,n){switch(e){case"REGEXP":return this.isConvertIncomePatterns&&(t=this.doTransormRegExp(t)),(0,b.default)(function(e,r){var i=e.match(t);i&&r(i[n.key],i[n.value])});case"FUNCTION":return(0,b.default)(t);default:throw Error("cant process type |"+e+"|, halt!")}}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(o),a=/((?:^|(?:(?:^|[^\\])\\(?:\\{2})*\\)|[^\\]+))(\[(?:]|(?:[^\\]+])|(?:.*?[^\\]+])|(?:.*?[^\\]+\\(?:\\{2})*\\])))/,s=/((?:^|[^\\])(?:\\{2})*)(\\\.)/,c=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),this.dotSubstitute=t,this.isDoLogging=n.log,this.doValidateDotSubstitute(this.dotSubstitute)}return i(e,[{key:"doValidateDotSubstitute",value:function(e){if(!e||"STRING"!==(0,u.default)(e))throw TypeError("constructor must be called with string as dot substitute, but got:\n|dotSubstitute| = |"+e+"|")}},{key:"getPatternByName",value:function(e){switch(e.toUpperCase()){case"CHARACTER_SET":return a;case"ESCAPED_DOT":return s;default:throw Error("so far dont know pattern, named |"+e+"|, mistype?")}}},{key:"doForgeDots",value:function(e){if(!e||"REGEXP"!==(0,u.default)(e))throw TypeError("must be called with RegExp, but got:\n|inRegexp| = |"+e+"|");return new RegExp(this.forgeEscapedDots(this.forgeCharacterSet(e.source)))}},{key:"forgeCharacterSet",value:function(e){var t=this,n=new RegExp(this.getPatternByName("character_set").source,"g"),r=function(e,n,r){return""+n+r.replace(/\./g,t.dotSubstitute)};return e.replace(n,r)}},{key:"forgeEscapedDots",value:function(e){var t=this,n=new RegExp(this.getPatternByName("escaped_dot").source,"g"),r=function(e,n,r){return""+n+r.replace(/\\\./,t.dotSubstitute)};return e.replace(n,r)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="function"==typeof Promise,i="undefined"!=typeof window?window:void 0!==t?t:self,o="location"in i&&"document"in i,u="undefined"!=typeof Symbol,a="undefined"!=typeof Map,s="undefined"!=typeof Set,c="undefined"!=typeof WeakMap,f="undefined"!=typeof WeakSet,l="undefined"!=typeof DataView,d=u&&void 0!==Symbol.iterator,p=u&&void 0!==Symbol.toStringTag,h=s&&"function"==typeof Set.prototype.entries,y=a&&"function"==typeof Map.prototype.entries,g=h&&Object.getPrototypeOf((new Set).entries()),v=y&&Object.getPrototypeOf((new Map).entries()),b=d&&"function"==typeof Array.prototype[Symbol.iterator],m=b&&Object.getPrototypeOf([][Symbol.iterator]()),E=d&&"function"==typeof String.prototype[Symbol.iterator],k=E&&Object.getPrototypeOf(""[Symbol.iterator]());e.exports=function(e){var t=void 0===e?"undefined":n(e);if("object"!==t)return t;if(null===e)return"null";if(e===i)return"global";if(Array.isArray(e)&&(!1===p||!(Symbol.toStringTag in e)))return"Array";if(o){if(e===i.location)return"Location";if(e===i.document)return"Document";if(e===(i.navigator||{}).mimeTypes)return"MimeTypeArray";if(e===(i.navigator||{}).plugins)return"PluginArray";if(e instanceof HTMLElement&&"BLOCKQUOTE"===e.tagName)return"HTMLQuoteElement";if(e instanceof HTMLElement&&"TD"===e.tagName)return"HTMLTableDataCellElement";if(e instanceof HTMLElement&&"TH"===e.tagName)return"HTMLTableHeaderCellElement"}var u=p&&e[Symbol.toStringTag];if("string"==typeof u)return u;var d=Object.getPrototypeOf(e);return d===RegExp.prototype?"RegExp":d===Date.prototype?"Date":r&&d===Promise.prototype?"Promise":s&&d===Set.prototype?"Set":a&&d===Map.prototype?"Map":f&&d===WeakSet.prototype?"WeakSet":c&&d===WeakMap.prototype?"WeakMap":l&&d===DataView.prototype?"DataView":a&&d===v?"Map Iterator":s&&d===g?"Set Iterator":b&&d===m?"Array Iterator":E&&d===k?"String Iterator":null===d?"Object":Object.prototype.toString.call(e).slice(8,-1)},e.exports.typeDetect=e.exports}).call(t,n(6))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),a=r(u),s=n(8),c=r(s),f=function(){function e(t,n,r){var o=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];i(this,e),this.originalObj=t,this.internalPathDelimiter=n,this.regexpTransformationFn=r,this.cacheStringifyedObject=null,this.stringificationRule={stubsList:[],stringifyFilter:null},this.maxTextLong=120,this.isConvertIncomePatterns=!0,this.isDoLogging=o.log}return o(e,[{key:"stringifyObject",value:function(e,t){var n=!1,r=this.stringificationRule.stringifyFilter,i=this.stringificationRule.stubsList;return e||(e=r),t||(t=i),n=this.cacheStringifyedObject&&(0,c.default)(e,r)&&(0,c.default)(t,i),this.isDoLogging&&console.log("stringify cache "+(n?"hit":"miss")),n||(this.cacheStringifyedObject=this.doStringification(e,t)),this.cacheStringifyedObject}},{key:"doStringification",value:function(e,t){var n=void 0,r=void 0,i=[],o=this.makeElementFilter(e),u=this.makeStringLimiter(this.maxTextLong),s=this.internalPathDelimiter,c=e?o:function(){return!0};return function e(t,o,f){switch(n=(0,a.default)(t)){case"HASH":r=Object.keys(t),r.length?r.forEach(function(n){c(o,n,f)&&e(t[n],""+o+n+s,f+1)}):e("__EMPTY__|HASH|",o,f);break;case"ARRAY":t.length?t.forEach(function(t,n){c(o,n,f)&&e(t,""+o+n+s,f+1)}):e("__EMPTY__|ARRAY|",o,f);break;case"NUMBER":case"BOOLEAN":case"NULL":i.push(""+o+t);break;case"STRING":i.push(u(o,t,f));break;case"DATE":case"REGEXP":i.push(o+"__"+n+"__|"+t+"|__");break;default:i.push(o+"__"+n+"__")}}(this.originalObj,"",0),i}},{key:"makeStringLimiter",value:function(e){return function(t,n){var r=n.length;return r>=e?t+"__LONG_TEXT__|"+r+"|":""+t+n}}},{key:"makeElementFilter",value:function(e){var t=void 0,n=void 0;return"HASH"===(0,a.default)(e)&&e.originPattern?(n=e.originPattern,this.isConvertIncomePatterns&&(n=this.regexpTransformationFn(n)),t=function(t,r){return t===e.elementName&&n.test(r)}):t=function(t){return t===e.elementName},function(n,r,i){return e.applyOnDepth!==i||t(r,n)}}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){return JSON.stringify(e)===JSON.stringify(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),a=r(u),s=n(1),c=r(s),f=n(2),l=r(f),d=function(){function e(t,n){i(this,e),this.dotInternal=t,this.dotExternal=n,this.convertBeforeFinalizeFunction=!0,this.convertOutResult=!0}return o(e,[{key:"finalizeResult",value:function(e,t){var n=this.getFinalizationName(e);return n?this.prepareFinalization(n,e)(t):t}},{key:"getFinalizationName",value:function(e){var t=!1;if(e&&(0,c.default)(e,"finalizeFn","Function")){if(this.convertBeforeFinalizeFunction)return"DECORATE_THEN_FINALAZE";t=!0}if(this.convertOutResult)return t?"FINALAZE_THEN_DECORATE":"DECORATE"}},{key:"prepareFinalization",value:function(e,t){var n=this.buildResultConvertor(),r=this.buildUserFinalizer(t);switch(e){case"DECORATE":return function(e){return n(e)};case"FINALAZE_THEN_DECORATE":return function(e){return n(r(e))};case"DECORATE_THEN_FINALAZE":return function(e){return r(n(e))};default:throw Error("unknown finalization style |"+e+"| used, halt!")}}},{key:"makeBuffingDelimiterWeel",value:function(){var e=this.dotExternal,t=this.dotInternal,n=new RegExp(t,"g");return function(r){var i=void 0;return"STRING"!==(0,a.default)(r)?r:(i=t===r.charAt(r.length-1)?r.slice(0,-1):r,i.replace(n,e))}}},{key:"buildResultConvertor",value:function(){var e=this.makeBuffingDelimiterWeel();return function(t){var n=void 0,r=void 0,i={};return Object.keys(t).forEach(function(o){r=t[o],n=e(o),i[n]=new Array(r.length),r.forEach(function(t,r){i[n][r]=e(t)})}),i}}},{key:"buildUserFinalizer",value:function(e){return(0,l.default)(e)}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(o),a=function(){function e(t){r(this,e),this.options=t,this.state={DEBUGGING:!1,LOGGING:!1,TIMING:!1,WARNING:!1},this.processOptions(),this.initState()}return i(e,[{key:"processOptions",value:function(){this.options&&!0===this.options.debug?(this.state.DEBUGGING=!0,this.options.timing=!0,this.options.logging=!0,this.options.warning=!0):this.state.debug=!1}},{key:"initState",value:function(){this.options&&(!0===this.options.timing&&"FUNCTION"===(0,u.default)(console.time)&&(this.state.TIMING=!0),!0===this.options.logging&&"FUNCTION"===(0,u.default)(console.log)&&(this.state.LOGGING=!0),!0===this.options.warning&&"FUNCTION"===(0,u.default)(console.warn)&&(this.state.WARNING=!0))}},{key:"mustDo",value:function(e){var t=e.toUpperCase(),n=this.state[t];if("BOOLEAN"!==(0,u.default)(n))throw Error("dont know |"+e+"| state");return n}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){var n=void 0,r={};if("HASH"!==(0,o.default)(e))throw TypeError("must called with object, but get |"+e+"|");return"HASH"!==(0,o.default)(t)?e:(Object.keys(e).forEach(function(i){n=(0,o.default)(t[i]),r[i]="NULL"!==n&&"UNDEFINED"!==n?t[i]:e[i]}),r)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=r,e.exports=t.default}])});