!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("TinyData",[],e):"object"==typeof exports?exports.TinyData=e():t.TinyData=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict";function r(t){if(!1===t||!0===t)return"BOOLEAN";switch((0,o.default)(t)){case"Object":return"HASH";case"Array":return"ARRAY";case"string":return"STRING";case"number":return"NUMBER";case"null":return"NULL";case"undefined":return"UNDEFINED";case"function":return"FUNCTION";case"RegExp":return"REGEXP";case"Date":return"DATE";case"Arguments":return"ARGUMENTS";default:return"OTHER"}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=r,t.exports=e.default},function(t,e,n){"use strict";function r(t,e,n){var r=void 0,i=(0,o.default)(t),a=function(t,n){return t+"\n|argName| = |"+e+"|\n|type| = |"+n+"|\n|arg| = |#{arg}|"};switch(i){case"STRING":try{r=["REGEXP",RegExp(t)]}catch(t){throw SyntaxError(a("cant compile this String to RegExp",i))}break;case"REGEXP":r=["REGEXP",t];break;case"FUNCTION":r=["FUNCTION",t];break;default:throw TypeError(a("argument must be String, RegExp or Function, but got",i))}if(n&&r[0]!==n.toUpperCase())throw TypeError(a("argument must be "+n+", but got",i));return r}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=r,t.exports=e.default},function(t,e,n){"use strict";function r(t){return function(e,n){var r=(0,a.default)(e),i=(0,a.default)(n);"NULL"!==r&&"UNDEFINED"!==r&&"NULL"!==i&&"UNDEFINED"!==i&&(t[e]||(t[e]=[]),t[e].push(n))}}function i(t){return function(e){var n={},i=(0,a.default)(e),o=r(n);switch(i){case"ARRAY":e.forEach(function(e){t(e,o)});break;case"HASH":Object.keys(e).forEach(function(n){t(n,e[n],o)});break;default:throw Error("cant work with object type |"+i+"|")}return n}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var u=n(4),s=r(u),c=n(7),f=r(c),l=n(9),d=r(l),p=n(10),h=r(p),g=n(1),y=r(g),v=n(2),b=r(v),m="ï¹…",E=".",k=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i(this,t),this.originalObj=e,this.options=n,this.isConvertIncomePatterns=!0,this.logger=new h.default(n),this.dotForger=new s.default(m,{log:this.logger.mustDo("logging")}),this.doTransormRegExp=this.doTransormRegExp.bind(this),this.stringificator=new f.default(e,m,this.doTransormRegExp,{log:this.logger.mustDo("logging")}),this.finalizer=new d.default(m,E)}return a(t,[{key:"search",value:function(t,e,n){var r={key:1,value:2};return Object.assign(r,n),this.logger.mustDo("warning")&&r.key>=r.value&&console.warn("for reverse interpretation direction it would be better to use #searchBack()\n|key_order| = |"+r.key+"|\n|value_order| = |"+r.value+"|"),this.seekOutAny(t,e,r)}},{key:"searchBack",value:function(t,e,n){var r={key:2,value:1};return Object.assign(r,n),this.logger.mustDo("warning")&&r.value>=r.key&&console.warn("for direct interpretation direction it would be better to use #search()\n|key_order| = |"+r.key+"|\n|value_order| = |"+r.value+"|"),this.seekOutAny(t,e,r)}},{key:"seekOut",value:function(t,e,n){return this.search(t,e,n)}},{key:"seekOutVerso",value:function(t,e,n){return this.searchBack(t,e,n)}},{key:"timeOnDemand",value:function(t,e){var n=void 0,r=this.logger.mustDo("timing");return r&&console.time(t),n=e(),r&&console.timeEnd(t),n}},{key:"rakeStringify",value:function(t){var e=this,n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return this.timeOnDemand("rakeStringify",function(){return e.stringificator.stringifyObject(t,n)})}},{key:"doTransormRegExp",value:function(t){return-1!==t.source.indexOf(m)?(this.logger.mustDo("logging")&&console.log("doTransormRegExp: skip converting for |"+t+"|"),t):this.dotForger.doForgeDots(t)}},{key:"getPathDelimiter",value:function(t){switch(t.toUpperCase()){case"INTERNAL":return m;case"EXTERNAL":return E;default:throw Error("dont know path delimiter, named |"+t+"|, mistype?")}}},{key:"getDataByPath",value:function(t,e,n){var r=void 0;return n||(n=t&&-1!==t.indexOf(m)?m:E),e||(e=this.originalObj),r=t.split(n),r.reduce(function(t,e){return t[e]},e)}},{key:"seekOutAny",value:function(t,e,n){var r=void 0,i=void 0,a=void 0,u=void 0,s=this.rakeStringify(),c=(0,y.default)(t,"seek_rule"),f=o(c,2);return r=f[0],i=f[1],a=this.buildSeekFunction(r,i,n),u=this.proceedSeekingOut(a,s),this.proceedFinalization(e,u)}},{key:"proceedFinalization",value:function(t,e){var n=this;return this.timeOnDemand("finalization",function(){return n.finalizer.finalizeResult(t,e)})}},{key:"proceedSeekingOut",value:function(t,e){return this.timeOnDemand("searching",function(){return t(e)})}},{key:"buildSeekFunction",value:function(t,e,n){switch(t){case"REGEXP":return this.isConvertIncomePatterns&&(e=this.doTransormRegExp(e)),(0,b.default)(function(t,r){var i=t.match(e);i&&r(i[n.key],i[n.value])});case"FUNCTION":return(0,b.default)(e);default:throw Error("cant process type |"+t+"|, halt!")}}}]),t}();e.default=k,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(o),u=/((?:^|(?:(?:^|[^\\])\\(?:\\{2})*\\)|[^\\]+))(\[(?:]|(?:[^\\]+])|(?:.*?[^\\]+])|(?:.*?[^\\]+\\(?:\\{2})*\\])))/,s=/((?:^|[^\\])(?:\\{2})*)(\\\.)/,c=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t),this.dotSubstitute=e,this.isDoLogging=n.log,this.doValidateDotSubstitute(this.dotSubstitute)}return i(t,[{key:"doValidateDotSubstitute",value:function(t){if(!t||"STRING"!==(0,a.default)(t))throw TypeError("constructor must be called with string as dot substitute, but got:\n|dotSubstitute| = |"+t+"|")}},{key:"getPatternByName",value:function(t){switch(t.toUpperCase()){case"CHARACTER_SET":return u;case"ESCAPED_DOT":return s;default:throw Error("so far dont know pattern, named |"+t+"|, mistype?")}}},{key:"doForgeDots",value:function(t){if(!t||"REGEXP"!==(0,a.default)(t))throw TypeError("must be called with RegExp, but got:\n|inRegexp| = |"+t+"|");return new RegExp(this.forgeEscapedDots(this.forgeCharacterSet(t.source)))}},{key:"forgeCharacterSet",value:function(t){var e=this,n=new RegExp(this.getPatternByName("character_set").source,"g"),r=function(t,n,r){return""+n+r.replace(/\./g,e.dotSubstitute)};return t.replace(n,r)}},{key:"forgeEscapedDots",value:function(t){var e=this,n=new RegExp(this.getPatternByName("escaped_dot").source,"g"),r=function(t,n,r){return""+n+r.replace(/\\\./,e.dotSubstitute)};return t.replace(n,r)}}]),t}();e.default=c,t.exports=e.default},function(t,e,n){"use strict";(function(e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="function"==typeof Promise,i="undefined"!=typeof window?window:void 0!==e?e:self,o="location"in i&&"document"in i,a="undefined"!=typeof Symbol,u="undefined"!=typeof Map,s="undefined"!=typeof Set,c="undefined"!=typeof WeakMap,f="undefined"!=typeof WeakSet,l="undefined"!=typeof DataView,d=a&&void 0!==Symbol.iterator,p=a&&void 0!==Symbol.toStringTag,h=s&&"function"==typeof Set.prototype.entries,g=u&&"function"==typeof Map.prototype.entries,y=h&&Object.getPrototypeOf((new Set).entries()),v=g&&Object.getPrototypeOf((new Map).entries()),b=d&&"function"==typeof Array.prototype[Symbol.iterator],m=b&&Object.getPrototypeOf([][Symbol.iterator]()),E=d&&"function"==typeof String.prototype[Symbol.iterator],k=E&&Object.getPrototypeOf(""[Symbol.iterator]());t.exports=function(t){var e=void 0===t?"undefined":n(t);if("object"!==e)return e;if(null===t)return"null";if(t===i)return"global";if(Array.isArray(t)&&(!1===p||!(Symbol.toStringTag in t)))return"Array";if(o){if(t===i.location)return"Location";if(t===i.document)return"Document";if(t===(i.navigator||{}).mimeTypes)return"MimeTypeArray";if(t===(i.navigator||{}).plugins)return"PluginArray";if(t instanceof HTMLElement&&"BLOCKQUOTE"===t.tagName)return"HTMLQuoteElement";if(t instanceof HTMLElement&&"TD"===t.tagName)return"HTMLTableDataCellElement";if(t instanceof HTMLElement&&"TH"===t.tagName)return"HTMLTableHeaderCellElement"}var a=p&&t[Symbol.toStringTag];if("string"==typeof a)return a;var d=Object.getPrototypeOf(t);return d===RegExp.prototype?"RegExp":d===Date.prototype?"Date":r&&d===Promise.prototype?"Promise":s&&d===Set.prototype?"Set":u&&d===Map.prototype?"Map":f&&d===WeakSet.prototype?"WeakSet":c&&d===WeakMap.prototype?"WeakMap":l&&d===DataView.prototype?"DataView":u&&d===v?"Map Iterator":s&&d===y?"Set Iterator":b&&d===m?"Array Iterator":E&&d===k?"String Iterator":null===d?"Object":Object.prototype.toString.call(t).slice(8,-1)},t.exports.typeDetect=t.exports}).call(e,n(6))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),u=r(a),s=n(8),c=r(s),f=function(){function t(e,n,r){var o=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];i(this,t),this.originalObj=e,this.internalPathDelimiter=n,this.regexpTransformationFn=r,this.cacheStringifyedObject=null,this.stringificationRule={stubsList:[],stringifyFilter:null},this.maxTextLong=120,this.isConvertIncomePatterns=!0,this.isDoLogging=o.log}return o(t,[{key:"stringifyObject",value:function(t,e){var n=!1,r=this.stringificationRule.stringifyFilter,i=this.stringificationRule.stubsList;return t||(t=r),e||(e=i),n=this.cacheStringifyedObject&&(0,c.default)(t,r)&&(0,c.default)(e,i),this.isDoLogging&&console.log("stringify cache "+(n?"hit":"miss")),n||(this.cacheStringifyedObject=this.doStringification(t,e)),this.cacheStringifyedObject}},{key:"doStringification",value:function(t,e){var n=void 0,r=void 0,i=[],o=this.makeElementFilter(t),a=this.makeStringLimiter(this.maxTextLong),s=this.internalPathDelimiter,c=t?o:function(){return!0};return function t(e,o,f){switch(n=(0,u.default)(e)){case"HASH":r=Object.keys(e),r.length?r.forEach(function(n){c(o,n,f)&&t(e[n],""+o+n+s,f+1)}):t("__EMPTY__|HASH|",o,f);break;case"ARRAY":e.length?e.forEach(function(e,n){c(o,n,f)&&t(e,""+o+n+s,f+1)}):t("__EMPTY__|ARRAY|",o,f);break;case"NUMBER":case"BOOLEAN":case"NULL":i.push(""+o+e);break;case"STRING":i.push(a(o,e,f));break;case"DATE":case"REGEXP":i.push(o+"__"+n+"__|"+e+"|__");break;default:i.push(o+"__"+n+"__")}}(this.originalObj,"",0),i}},{key:"makeStringLimiter",value:function(t){return function(e,n){var r=n.length;return r>=t?e+"__LONG_TEXT__|"+r+"|":""+e+n}}},{key:"makeElementFilter",value:function(t){var e=void 0,n=void 0;return"HASH"===(0,u.default)(t)&&t.originPattern?(n=t.originPattern,this.isConvertIncomePatterns&&(n=this.regexpTransformationFn(n)),e=function(e,r){return e===t.elementName&&n.test(r)}):e=function(e){return e===t.elementName},function(n,r,i){return t.applyOnDepth!==i||e(r,n)}}}]),t}();e.default=f,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){return JSON.stringify(t)===JSON.stringify(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),u=r(a),s=n(1),c=r(s),f=n(2),l=r(f),d=function(){function t(e,n){i(this,t),this.dotInternal=e,this.dotExternal=n,this.convertBeforeFinalizeFunction=!0,this.convertOutResult=!0}return o(t,[{key:"finalizeResult",value:function(t,e){var n=this.getFinalizationName(t);return n?this.prepareFinalization(n,t)(e):e}},{key:"getFinalizationName",value:function(t){var e=!1;if(t&&(0,c.default)(t,"finalizeFn","Function")){if(this.convertBeforeFinalizeFunction)return"DECORATE_THEN_FINALAZE";e=!0}if(this.convertOutResult)return e?"FINALAZE_THEN_DECORATE":"DECORATE"}},{key:"prepareFinalization",value:function(t,e){var n=this.buildResultConvertor(),r=this.buildUserFinalizer(e);switch(t){case"DECORATE":return function(t){return n(t)};case"FINALAZE_THEN_DECORATE":return function(t){return n(r(t))};case"DECORATE_THEN_FINALAZE":return function(t){return r(n(t))};default:throw Error("unknown finalization style |"+t+"| used, halt!")}}},{key:"makeBuffingDelimiterWeel",value:function(){var t=this.dotExternal,e=this.dotInternal,n=new RegExp(e,"g");return function(r){var i=void 0;return"STRING"!==(0,u.default)(r)?r:(i=e===r.charAt(r.length-1)?r.slice(0,-1):r,i.replace(n,t))}}},{key:"buildResultConvertor",value:function(){var t=this.makeBuffingDelimiterWeel();return function(e){var n=void 0,r=void 0,i={};return Object.keys(e).forEach(function(o){r=e[o],n=t(o),i[n]=new Array(r.length),r.forEach(function(e,r){i[n][r]=t(e)})}),i}}},{key:"buildUserFinalizer",value:function(t){return(0,l.default)(t)}}]),t}();e.default=d,t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(o),u=function(){function t(e){r(this,t),this.options=e,this.state={DEBUGGING:!1,LOGGING:!1,TIMING:!1,WARNING:!1},this.processOptions(),this.initState()}return i(t,[{key:"processOptions",value:function(){this.options&&!0===this.options.debug?(this.state.DEBUGGING=!0,this.options.timing=!0,this.options.logging=!0,this.options.warning=!0):this.state.debug=!1}},{key:"initState",value:function(){this.options&&(!0===this.options.timing&&"FUNCTION"===(0,a.default)(console.time)&&(this.state.TIMING=!0),!0===this.options.logging&&"FUNCTION"===(0,a.default)(console.log)&&(this.state.LOGGING=!0),!0===this.options.warning&&"FUNCTION"===(0,a.default)(console.warn)&&(this.state.WARNING=!0))}},{key:"mustDo",value:function(t){var e=t.toUpperCase(),n=this.state[e];if("BOOLEAN"!==(0,a.default)(n))throw Error("dont know |"+t+"| state");return n}}]),t}();e.default=u,t.exports=e.default}])});