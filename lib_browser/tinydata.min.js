(function(){if(!this.require){var t={},e={},n=function(o,s){var _,u=r(s,o),l=e[u];if(l)return l.exports;if(!(_=t[u]||t[u=r(u,"./index")]))throw"module '"+o+"' not found";l={id:u,exports:{}};try{return e[u]=l,_(l.exports,function(t){return n(t,i(u))},l),l.exports}catch(a){throw delete e[u],a}},r=function(t,e){var n,r,i=[];n=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var o=0,s=n.length;s>o;o++)r=n[o],".."==r?i.pop():"."!=r&&""!=r&&i.push(r);return i.join("/")},i=function(t){return t.split("/").slice(0,-1).join("/")};this.require=function(t){return n(t,"")},this.require.define=function(e){for(var n in e)t[n]=e[n]}}return this.require.define}).call(this)({regexp_dot_forger:function(t,e,n){(function(){var t,r,i,o,s=[].slice;r=function(t){return function(){var e,n;return e=arguments.length>=1?s.call(arguments,0):[],n=t.apply(this,e),this._do_logging_&&console.log(""+e[0]+" -> "+n),n}},i=null!=(o=this._)?o:e("lodash"),t=function(){function t(t,e){if(this._dot_substitute_=t,this._options_=null!=e?e:{},null==this._dot_substitute_||!i.isString(this._dot_substitute_))throw Error("constructor must be called with string as dot substitute, but got:\n|dot_substitute| = |"+this._dot_substitute_+"|");this._do_logging_=null!=this._options_.log&&this._options_.log===!0&&null!=("undefined"!=typeof console&&null!==console?console.log:void 0)?!0:!1}return t.prototype.getPatternByName=function(t){switch(t.toUpperCase()){case"CHARACTER_SET":return/((?:^|(?:(?:^|[^\\])\\(?:\\{2})*\\)|[^\\]+))(\[(?:]|(?:[^\\]+])|(?:.*?[^\\]+])|(?:.*?[^\\]+\\(?:\\{2})*\\])))/;case"ESCAPED_DOT":return/((?:^|[^\\])(?:\\{2})*)(\\\.)/;default:throw Error("so far don`t know pattern, named |"+t+"|, mistype?")}},t.prototype.doForgeDots=r(function(t){if(null==t||!i.isRegExp(t))throw Error("must be called with RegExp, but got:\n|in_regexp| = |"+t+"|");return RegExp(this._forgeEscapedDots(this._forgeCharacterSet(t.source)))}),t.prototype._forgeCharacterSet=function(t){var e,n,r=this;return n=RegExp(this.getPatternByName("character_set").source,"g"),e=function(t,e,n){var i;return i=n.replace(/\./g,r._dot_substitute_),e+i},t.replace(n,e)},t.prototype._forgeEscapedDots=function(t){var e,n,r=this;return n=RegExp(this.getPatternByName("escaped_dot").source,"g"),e=function(t,e,n){var i;return i=n.replace(/\\\./,r._dot_substitute_),e+i},t.replace(n,e)},t}(),n.exports=t}).call(this)},tinydata:function(t,e,n){(function(){var t,r,i,o,s,_,u=function(t,e){return function(){return t.apply(e,arguments)}};o=function(t,e){return function(){var n;return this._do_timing_&&console.time(t),n=e.apply(this,arguments),this._do_timing_&&console.timeEnd(t),n}},i=function(t){return function(e,n){var r,i,o;return i=this._stringification_rule.stringify_filter,r=this._stringification_rule.stubs_list,null!=this._cache_stringifyed_object_&&s.isEqual(e,i)&&s.isEqual(n,r)?(this._do_logging_&&console.log("stringify cache hit"),this._cache_stringifyed_object_):(this._do_logging_&&console.log("stringify cache miss"),o=[e,n],i=o[0],r=o[1],this._cache_stringifyed_object_=t.call(this,e,n))}},s=null!=(_=this._)?_:e("lodash"),t=e("./regexp_dot_forger"),r=function(){function e(e,n){this._original_obj_=null!=e?e:{},this._options_=null!=n?n:{},this.doTransormRegExp=u(this.doTransormRegExp,this),this._cache_stringifyed_object_=null,this._stringification_rule={stubs_list:[],stringify_filter:null,apply_on_depth:null},this._max_text_long_=120,null!=this._options_.debug&&this._options_.debug===!0&&(this._options_.timing=!0,this._options_.logging=!0),this._do_timing_=null!=this._options_.timing&&this._options_.timing===!0&&null!=("undefined"!=typeof console&&null!==console?console.time:void 0)?!0:!1,this._do_logging_=null!=this._options_.logging&&this._options_.logging===!0&&null!=("undefined"!=typeof console&&null!==console?console.log:void 0)?!0:!1,this._dot_={internal:"ï¹…",external:"."},this._dot_decorator_settings_={rakeAny:{convert_income_rake_regexp:!0,convert_before_finalize_function:!0,convert_out_result:!0},rakeStringify:{convert_stringify_filter:!0}},this._dot_forger_=new t(this.getPathDelimiter("internal"),{log:this._do_logging_})}return e.prototype.sortOutVerso=function(t,e){var n,r,i,o,s,_,u;return u=this._argParser(t,"rake_rule"),s=u[0],o=u[1],i=this._buildRakeFunction(s,o),this.rakeStringify(this._stringification_rule.stringify_filter,this._stringification_rule.stubs_list),_=this._proceedRake(i),(n=this._getFinalizationName(e))?(r=this._prepareFinalization(n,e),r(_)):_},e.prototype.rakeStringify=i(o("rakeStringify",function(t,e){return null==e&&(e=[]),this._doStringify(t,e)})),e.prototype.doTransormRegExp=function(t){return-1!==t.source.indexOf(this.getPathDelimiter("internal"))?(this._do_logging_&&console.log("doTransormRegExp: skip converting for |"+t+"|"),t):this._dot_forger_.doForgeDots(t)},e.prototype.getPathDelimiter=function(t){switch(t.toUpperCase()){case"INTERNAL":return this._dot_.internal;case"EXTERNAL":return this._dot_.external;default:throw Error("so far don`t know path delimiter, named |"+t+"|, mistype?")}},e.prototype._getFinalizationName=function(t){var e;if(e=!1,null!=t&&this._argParser(t,"finalize_function","Function")){if(this._dot_decorator_settings_.rakeAny.convert_before_finalize_function)return"DECORATE_THEN_FINALAZE";e=!0}return this._dot_decorator_settings_.rakeAny.convert_out_result?e?"FINALAZE_THEN_DECORATE":"DECORATE":void 0},e.prototype._prepareFinalization=function(t,e){var n,r;switch(n=this._buildResultConvertor(),r=this._buildUserFinalizer(e),t){case"DECORATE":return function(t){return n(t)};case"FINALAZE_THEN_DECORATE":return function(t){return n(r(t))};case"DECORATE_THEN_FINALAZE":return function(t){return r(n(t))};default:throw Error("WTF???!!!")}},e.prototype._buildResultConvertor=function(){var t,e;return t=RegExp(this.getPathDelimiter("internal"),"g"),e=this.getPathDelimiter("external"),function(n){var r,i,o,_,u,l,a,c,g;for(c=s.keys(n),_=0,l=c.length;l>_;_++)for(o=c[_],g=n[o],r=u=0,a=g.length;a>u;r=++u)i=g[r],n[o][r]=n[o][r].replace(t,e);return n}},e.prototype._buildUserFinalizer=function(t){var e=this;return function(n){var r,i,o,_,u,l;for(i={},r=function(t,e){var n;return null!=t&&null!=e?(null==(n=i[t])&&(i[t]=[]),i[t].push(e)):void 0},l=s.keys(n),_=0,u=l.length;u>_;_++)o=l[_],t.call(e,o,n[o],r);return i}},e.prototype._proceedRake=o("proceedRake",function(t){var e;return e=t(this._cache_stringifyed_object_)}),e.prototype._buildRakeFunction=function(t,e){var n=this;switch(t){case"REGEXP":return this._dot_decorator_settings_.rakeAny.convert_income_rake_regexp&&(e=this.doTransormRegExp(e)),function(t){var n,r,i,o,s,_,u,l,a;for(o={},_=0,u=t.length;u>_;_++)n=t[_],(i=n.match(e))&&(l=[i[2],i[1].slice(0,-1)],r=l[0],s=l[1],null==(a=o[r])&&(o[r]=[]),o[r].push(s));return o};case"FUNCTION":return function(t){var r,i,o,s,_;for(o={},r=function(t,e){var n;return null!=t&&null!=e?(null==(n=o[t])&&(o[t]=[]),o[t].push(e)):void 0},s=0,_=t.length;_>s;s++)i=t[s],e.call(n,i,r);return o};default:throw Error("WTF???!!")}},e.prototype._argParser=function(t,e,n){var r,i,o;if(i=function(n,r){return""+n+"\n|arg_name| = |"+e+"|\n|type| = |"+r+"|\n|arg|   = |"+t+"|"},o=function(){switch(r=this._getItType(t)){case"STRING":try{return["REGEXP",RegExp(t)]}catch(e){throw SyntaxError(i("cant compile this String to RegExp",r))}break;case"REGEXP":return["REGEXP",t];case"FUNCTION":return["FUNCTION",t];default:throw TypeError(i("argument must be String, RegExp or Function, but got",r))}}.call(this),null!=n&&o[0]!==n.toUpperCase())throw TypeError(i("argument must be "+n+", but got",r));return o},e.prototype._doStringify=function(t){var e,n,r,i,o,_,u,l,a=this;return _=[],o=null!=(null!=t?t.origin_pattern:void 0)?(l=t.origin_pattern,this._dot_decorator_settings_.rakeStringify.convert_stringify_filter?l=this.doTransormRegExp(l):void 0,function(e,n){return e===t.element_name&&l.test(n)}):function(e){return e===t.element_name},n=function(e,n,r){return t.apply_on_depth===r?o(n,e):!0},u=function(t,e){var n;return n=e.length,n>a._max_text_long_?""+t+"__LONG_TEXT__|"+n+"|":""+t+e},i=null!=t?n:function(){return!0},e=this.getPathDelimiter("internal"),r=function(t,n,o){var l,c,g,h,f,p,d,E,y;switch(c=a._getItType(t)){case"HASH":if(h=s.keys(t),h.length)for(p=0,E=h.length;E>p;p++)g=h[p],i(n,g,o)&&r(t[g],""+n+g+e,o+1);else r("__EMPTY__|HASH|",""+n,o);break;case"ARRAY":if(t.length)for(l=d=0,y=t.length;y>d;l=++d)f=t[l],i(n,l,o)&&r(f,""+n+l+e,o+1);else r("__EMPTY__|ARRAY|",""+n,o);break;case"PLAIN":_.push(""+n+t);break;case"STRING":_.push(u(n,t,o));break;case"DATE":case"REGEXP":_.push(""+n+"__"+c+"__|"+t+"|__");break;default:_.push(""+n+"__"+c+"__")}return null},r(this._original_obj_,"",0),_},e.prototype._getItType=function(t){return s.isPlainObject(t)?"HASH":s.isArray(t)?"ARRAY":s.isString(t)?"STRING":s.isNumber(t)||s.isBoolean(t)||s.isNull(t)?"PLAIN":s.isFunction(t)?"FUNCTION":s.isRegExp(t)?"REGEXP":s.isDate(t)?"DATE":s.isArguments(t)?"ARGUMENTS":"OTHER"},e}(),n.exports=r}).call(this)}});